---
title:  Vue Router
date: 2022-06-09 16:22:20
permalink: /pages/2ab1b4/
categories:
  - ã€ŠVueã€‹
tags:
  - 
---
## 6.1 ç›¸å…³æ¦‚å¿µ
### 6.1.1 è·¯ç”±
1. è·¯ç”±æ¦‚å¿µ
   1. ä¸€ä¸ªè·¯ç”±å°±æ˜¯ä¸€ç»„æ˜ å°„å…³ç³»ï¼ˆkey - valueï¼‰
   2. keyä¸ºè·¯å¾„ï¼Œvalueå¯èƒ½æ˜¯functionæˆ–componen
2. è·¯ç”±åˆ†ç±»
   1. åç«¯è·¯ç”±
      1. ç†è§£ï¼švalueæ˜¯functionï¼Œç”¨äºå¤„ç†å®¢æˆ·ç«¯æäº¤çš„è¯·æ±‚
      2. å·¥ä½œè¿‡ç¨‹ï¼šæœåŠ¡å™¨æ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œæ ¹æ®è¯·æ±‚è·¯å¾„æ‰¾åˆ°åŒ¹é…çš„å‡½æ•°æ¥å¤„ç†è¯·æ±‚ï¼Œè¿”å›å“åº”æ•°æ®
   2. å‰ç«¯è·¯ç”±
      1. ç†è§£ï¼švalueæ˜¯componentï¼Œç”¨äºå±•ç¤ºé¡µé¢å†…å®¹
      2. å·¥ä½œè¿‡ç¨‹ï¼šå½“æµè§ˆå™¨çš„è·¯å¾„æ”¹å˜æ—¶ï¼Œå¯¹åº”çš„ç»„ä»¶å°±ä¼šæ˜¾ç¤º
### 6.1.2 SPAåº”ç”¨
1. å•é¡µWebåº”ç”¨ï¼ˆsingle page web applicationï¼ŒSPAï¼‰
2. æ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå®Œæ•´çš„é¡µé¢
3. ç‚¹å‡»é¡µé¢ä¸­çš„å¯¼èˆªé“¾æ¥ä¸ä¼šåˆ·æ–°é¡µé¢ï¼Œåªä¼šåšé¡µé¢çš„å±€éƒ¨æ›´æ–°
4. æ•°æ®éœ€è¦é€šè¿‡ajaxè¯·æ±‚è·å–

## 6.2 åŸºæœ¬è·¯ç”±
### 6.2.1 åŸºæœ¬è·¯ç”±ä½¿ç”¨
1. å®‰è£…vue-routerï¼Œå‘½ä»¤`npm i vue-router`
2. åº”ç”¨æ’ä»¶`Vue.use(VueRouter)`
3. ç¼–å†™routeré…ç½®é¡¹
```javascript
import VueRouter from 'vue-router'			// å¼•å…¥VueRouter
import About from '../components/About'	// è·¯ç”±ç»„ä»¶
import Home from '../components/Home'		// è·¯ç”±ç»„ä»¶

// åˆ›å»ºrouterå®ä¾‹å¯¹è±¡ï¼Œå»ç®¡ç†ä¸€ç»„ä¸€ç»„çš„è·¯ç”±è§„åˆ™
const router = new VueRouter({
	routes:[
		{
			path:'/about',
			component:About
		},
		{
			path:'/home',
			component:Home
		}
	]
})

//æš´éœ²router
export default router
```
4. å®ç°åˆ‡æ¢`<router-link></router-link>`æµè§ˆå™¨ä¼šè¢«æ›¿æ¢ä¸ºaæ ‡ç­¾,`active-class`å¯é…ç½®é«˜äº®æ ·å¼
```html
<router-link active-class="active" to="/about">About</router-link>
```
5. æŒ‡å®šå±•ç¤ºä½`<router-view></router-view>`
### 6.2.2 æ³¨æ„äº‹é¡¹
1. è·¯ç”±ç»„ä»¶é€šå¸¸å­˜æ”¾åœ¨pagesæ–‡ä»¶å¤¹ï¼Œä¸€èˆ¬ç»„ä»¶é€šå¸¸å­˜æ”¾åœ¨componentsæ–‡ä»¶å¤¹
2. é€šè¿‡åˆ‡æ¢ï¼Œâ€œéšè—â€äº†çš„è·¯ç”±ç»„ä»¶ï¼Œé»˜è®¤æ˜¯è¢«é”€æ¯æ‰çš„ï¼Œéœ€è¦çš„æ—¶å€™å†å»æŒ‚è½½
3. æ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„`$route`å±æ€§ï¼Œé‡Œé¢å­˜å‚¨ç€è‡ªå·±çš„è·¯ç”±ä¿¡æ¯
4. æ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªrouterï¼Œå¯ä»¥é€šè¿‡ç»„ä»¶çš„`$router`å±æ€§è·å–åˆ°

## 6.3 å¤šçº§è·¯ç”±
1. é…ç½®è·¯ç”±è§„åˆ™ï¼Œä½¿ç”¨childrené…ç½®é¡¹
```javascript
routes:[
	{
		path:'/about',
		component:About,
	},
	{
		path:'/home',
		component:Home,
		children:[ 					// é€šè¿‡childrené…ç½®å­çº§è·¯ç”±
			{
				path:'news', 		// æ­¤å¤„ä¸€å®šä¸è¦å¸¦æ–œæ ï¼Œå†™æˆ /news
				component:News
			},
			{
				path:'message',	// æ­¤å¤„ä¸€å®šä¸è¦å†™æˆ /message
				component:Message
			}
		]
	}
]
```
2. è·³è½¬ï¼ˆè¦å†™å®Œæ•´è·¯å¾„ï¼‰`<router-link to="/home/news">News</router-link>`

## 6.4 è·¯ç”±ä¼ å‚
### 6.4.1 queryå‚æ•°
1. ä¼ é€’queryå‚æ•°
```html
<!-- è·³è½¬å¹¶æºå¸¦queryå‚æ•°ï¼Œtoçš„å­—ç¬¦ä¸²å†™æ³• -->
<router-link :to="`/home/message/detail?id=${m.id}&title=${m.title}`">è·³è½¬</router-link>
				
<!-- è·³è½¬å¹¶æºå¸¦queryå‚æ•°ï¼Œtoçš„å¯¹è±¡å†™æ³•ï¼ˆæ¨èï¼‰ -->
<router-link 
	:to="{
		path:'/home/message/detail',
		query:{
		    id: m.id,
            title: m.title
		}
	}"
>è·³è½¬</router-link>
```
2. æ¥æ”¶queryå‚æ•°`$route.query.id`,`$route.query.title`
### 6.4.2 paramså‚æ•°
1. é…ç½®è·¯ç”±ï¼Œå£°æ˜æ¥æ”¶paramså‚æ•°
```javascript
{
	path:'/home',
	component:Home,
	children:[
		{
			path:'news',
			component:News
		},
		{
			component:Message,
			children:[
				{
					name:'xiangqing',
					path:'detail/:id/:title', // ğŸ”´ä½¿ç”¨å ä½ç¬¦å£°æ˜æ¥æ”¶paramså‚æ•°
					component:Detail
				}
			]
		}
	]
}
```
2. ä¼ é€’å‚æ•°ï¼š**ç‰¹åˆ«æ³¨æ„**ï¼šè·¯ç”±æºå¸¦paramså‚æ•°æ—¶ï¼Œè‹¥ä½¿ç”¨toçš„å¯¹è±¡å†™æ³•ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨pathé…ç½®é¡¹ï¼Œå¿…é¡»ä½¿ç”¨nameé…ç½®ï¼
```html
<!-- è·³è½¬å¹¶æºå¸¦paramså‚æ•°ï¼Œtoçš„å­—ç¬¦ä¸²å†™æ³• -->
<router-link :to="/home/message/detail/666/ä½ å¥½">è·³è½¬</router-link>
				
<!-- è·³è½¬å¹¶æºå¸¦paramså‚æ•°ï¼Œtoçš„å¯¹è±¡å†™æ³• -->
<router-link 
	:to="{
		name:'xiangqing',
		params:{
		    id:666,
            title:'ä½ å¥½'
		}
	}"
>è·³è½¬</router-link>
```
3. æ¥æ”¶å‚æ•°`$route.params.id``$route.params.title`
### 6.4.3 è·¯ç”±propsé…ç½®
1. propsä½œç”¨ï¼šè®©è·¯ç”±ç»„ä»¶æ›´æ–¹ä¾¿çš„æ”¶åˆ°å‚æ•°
2. åœ¨`router/index.js`é‡Œå¢åŠ propsé…ç½®
```javascript
{
	name:'xiangqing',
	path:'detail/:id',
	component:Detail,

	//ç¬¬ä¸€ç§å†™æ³•ï¼špropså€¼ä¸ºå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­æ‰€æœ‰çš„key-valueçš„ç»„åˆæœ€ç»ˆéƒ½ä¼šé€šè¿‡propsä¼ ç»™Detailç»„ä»¶
	props:{a:900},

	//ç¬¬äºŒç§å†™æ³•ï¼špropså€¼ä¸ºå¸ƒå°”å€¼ï¼Œä¸ºtrueæ—¶ï¼Œåˆ™æŠŠè·¯ç”±æ”¶åˆ°çš„æ‰€æœ‰paramså‚æ•°é€šè¿‡propsä¼ ç»™Detailç»„ä»¶
	props:true,
	
	//ç¬¬ä¸‰ç§å†™æ³•ï¼špropså€¼ä¸ºå‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›çš„å¯¹è±¡ä¸­æ¯ä¸€ç»„key-valueéƒ½ä¼šé€šè¿‡propsä¼ ç»™Detailç»„ä»¶
	props($route){
		return {
			id: $route.query.id,
			title: $route.query.title
		}
	}
}
```

## 6.5 å‘½åè·¯ç”±
1. ä½œç”¨ï¼šå¯ä»¥ç®€åŒ–è·¯ç”±çš„è·³è½¬
### 6.5.1 å‘½åè·¯ç”±ä½¿ç”¨
1. ç»™è·¯ç”±å‘½å 
```javascript
{
	path:'/demo',
	component:Demo,
	children:[
		{
			path:'test',
			component:Test,
			children:[
				{
          name:'hello' // ç»™è·¯ç”±å‘½å
					path:'welcome',
					component:Hello,
				}
			]
		}
	]
}
```
2. ç®€åŒ–è·³è½¬
```html
<!--ç®€åŒ–å‰ï¼Œéœ€è¦å†™å®Œæ•´çš„è·¯å¾„ -->
<router-link to="/demo/test/welcome">è·³è½¬</router-link>

<!--ç®€åŒ–åï¼Œç›´æ¥é€šè¿‡åå­—è·³è½¬ -->
<router-link :to="{name:'hello'}">è·³è½¬</router-link>

<!--ç®€åŒ–å†™æ³•é…åˆä¼ é€’å‚æ•° -->
<router-link 
	:to="{
		name:'hello',
		query:{
		    id:666,
            title:'ä½ å¥½'
		}
	}"
>è·³è½¬</router-link>
```

## 6.6 è·¯ç”±è·³è½¬replaceæ¨¡å¼
1. ä½œç”¨ï¼šæ§åˆ¶è·¯ç”±è·³è½¬æ—¶æ“ä½œæµè§ˆå™¨å†å²è®°å½•çš„æ¨¡å¼
2. æµè§ˆå™¨çš„å†å²è®°å½•æœ‰ä¸¤ç§å†™å…¥æ–¹å¼ï¼špushå’Œreplace
   1. pushæ˜¯è¿½åŠ å†å²è®°å½•
   2. replaceæ˜¯æ›¿æ¢å½“å‰è®°å½•ï¼Œè·¯ç”±è·³è½¬æ—¶å€™é»˜è®¤ä¸ºpushæ–¹å¼
3. å¼€å¯replaceæ¨¡å¼`<router-link :replace="true" ...>News</router-link>`
4. ç®€å†™`<router-link replace ...>News</router-link>`
5. æ€»ç»“ï¼šæµè§ˆè®°å½•æœ¬è´¨æ˜¯ä¸€ä¸ªæ ˆï¼Œé»˜è®¤pushï¼Œç‚¹å¼€æ–°é¡µé¢å°±ä¼šåœ¨æ ˆé¡¶è¿½åŠ ä¸€ä¸ªåœ°å€ï¼Œåé€€ï¼Œæ ˆé¡¶æŒ‡é’ˆå‘ä¸‹ç§»åŠ¨ï¼Œæ”¹ä¸ºreplaceå°±æ˜¯ä¸è¿½åŠ ï¼Œè€Œå°†æ ˆé¡¶åœ°å€æ›¿æ¢

## 6.7 ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª
1. ä½œç”¨ï¼šä¸å€ŸåŠ©`<router-link>`å®ç°è·¯ç”±è·³è½¬ï¼Œè®©è·¯ç”±è·³è½¬æ›´åŠ çµæ´»
2. `this.$router.push({})`å†…ä¼ çš„å¯¹è±¡ä¸`<router-link>`ä¸­çš„toç›¸åŒ
3. `this.$router.replace({})`	
4. `this.$router.forward()`å‰è¿›
5. `this.$router.back()`åé€€
6. `this.$router.go(n)`å¯å‰è¿›ä¹Ÿå¯åé€€ï¼Œnä¸ºæ­£æ•°å‰è¿›nï¼Œä¸ºè´Ÿæ•°åé€€

## 6.8 ç¼“å­˜è·¯ç”±ç»„ä»¶
1. ä½œç”¨ï¼šè®©ä¸å±•ç¤ºçš„è·¯ç”±ç»„ä»¶ä¿æŒæŒ‚è½½ï¼Œä¸è¢«é”€æ¯
2. `<keep-alive include="News"><router-view></router-view></keep-alive>`
3. `<keep-alive :include="['News', 'Message']"><router-view></router-view></keep-alive>`

## 6.9 è·¯ç”±ç›¸å…³ç”Ÿå‘½é’©å­
1. activatedå’Œdeactivatedæ˜¯è·¯ç”±ç»„ä»¶æ‰€ç‹¬æœ‰çš„ä¸¤ä¸ªé’©å­ï¼Œç”¨äºæ•è·è·¯ç”±ç»„ä»¶çš„æ¿€æ´»çŠ¶æ€
2. activatedè·¯ç”±ç»„ä»¶è¢«æ¿€æ´»æ—¶è§¦å‘
3. deactivatedè·¯ç”±ç»„ä»¶å¤±æ´»æ—¶è§¦å‘

## 6.10 è·¯ç”±å®ˆå«
1. ä½œç”¨ï¼šå¯¹è·¯ç”±è¿›è¡Œæƒé™æ§åˆ¶ 
2. åˆ†ç±»ï¼šå…¨å±€å®ˆå«ã€ç‹¬äº«å®ˆå«ã€ç»„ä»¶å†…å®ˆå« 
### 6.10.1 å…¨å±€å‰ç½®å®ˆå«
1. æ¯æ¬¡è·¯ç”±åˆ‡æ¢ä¹‹å‰å’Œåˆå§‹åŒ–æ—¶è¢«è°ƒç”¨
2. `router.beforeEach((to,from,next) => {})`
3. `to`æ˜¯è·¯ç”±å»å¾€çš„ä¿¡æ¯ï¼Œ`from`æ˜¯è·³è½¬è·¯ç”±å‰çš„ä¿¡æ¯ï¼Œ`next()`æ”¾è¡Œ
4. `meta`è·¯ç”±å…ƒä¿¡æ¯ï¼Œæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ä¿¡æ¯
```javascript
router.beforeEach((to,from,next) => {
	console.log('beforeEach',to,from)
	if(to.meta.isAuth){ // åˆ¤æ–­å½“å‰è·¯ç”±æ˜¯å¦éœ€è¦è¿›è¡Œæƒé™æ§åˆ¶
		if(localStorage.getItem('school') === 'atguigu'){ // æƒé™æ§åˆ¶çš„å…·ä½“è§„åˆ™
			next()	// æ”¾è¡Œ
		}else{
			alert('æš‚æ— æƒé™æŸ¥çœ‹')
		}
	}else{
		next()	// æ”¾è¡Œ
	}
})
```
### 6.10.2 å…¨å±€åç½®å®ˆå«
1. æ¯æ¬¡è·¯ç”±åˆ‡æ¢åå’Œåˆå§‹åŒ–æ—¶è¢«è°ƒç”¨ï¼Œæ²¡æœ‰`next()`æ–¹æ³•
2. ç”¨æ¥åˆ‡æ¢æ ‡ç­¾é¡µåå­—
```javascript
router.afterEach((to,from) => {
	console.log('afterEach',to,from)
	if(to.meta.title){ 
		document.title = to.meta.title //ä¿®æ”¹ç½‘é¡µçš„title
	}else{
		document.title = 'vue_test'
	}
})
```
### 6.10.3 ç‹¬äº«å®ˆå«
1. æ˜¯routesçš„ä¸€ä¸ªé…ç½®é¡¹
2. æ²¡æœ‰ç‹¬äº«åç½®è·¯ç”±å®ˆå«
```javascript
beforeEnter(to,from,next){
	console.log('beforeEnter',to,from)
    if(localStorage.getItem('school') === 'atguigu'){
        next()
    }else{
        alert('æš‚æ— æƒé™æŸ¥çœ‹')
    }
}
```
### 6.10.4 ç»„ä»¶å†…å®ˆå«
1. ç±»ä¼¼äºç”Ÿå‘½å‘¨æœŸ
2. æ˜¯é€šè¿‡è·¯ç”±è¿›å…¥ç¦»å¼€ç»„ä»¶æ‰ä¼šè§¦å‘ï¼Œç›´æ¥æ”¾åœ¨é¡µé¢ä¸Šçš„æ˜¯ä¸è§¦å‘çš„
```javascript
//è¿›å…¥å®ˆå«ï¼šé€šè¿‡è·¯ç”±è§„åˆ™ï¼Œè¿›å…¥è¯¥ç»„ä»¶æ—¶è¢«è°ƒç”¨
beforeRouteEnter (to, from, next) {... next()},

//ç¦»å¼€å®ˆå«ï¼šé€šè¿‡è·¯ç”±è§„åˆ™ï¼Œç¦»å¼€è¯¥ç»„ä»¶æ—¶è¢«è°ƒç”¨
beforeRouteLeave (to, from, next) {... next()},
```

## 6.11 è·¯ç”±å™¨çš„å·¥ä½œæ¨¡å¼
1. å¯¹äºä¸€ä¸ªurlæ¥è¯´ï¼Œ#åŠå…¶åé¢çš„å†…å®¹å°±æ˜¯hashå€¼
2. hashå€¼ä¸ä¼šåŒ…å«åœ¨HTTPè¯·æ±‚ä¸­ï¼Œå³ï¼šhashå€¼ä¸ä¼šå¸¦ç»™æœåŠ¡å™¨ 
### 6.11.1 hashæ¨¡å¼ 
1. åœ°å€ä¸­æ°¸è¿œå¸¦ç€#å·ï¼Œä¸ç¾è§‚
2. è‹¥ä»¥åå°†åœ°å€é€šè¿‡ç¬¬ä¸‰æ–¹æ‰‹æœºappåˆ†äº«ï¼Œè‹¥appæ ¡éªŒä¸¥æ ¼ï¼Œåˆ™åœ°å€ä¼šè¢«æ ‡è®°ä¸ºä¸åˆæ³•
3. å…¼å®¹æ€§è¾ƒå¥½
### 6.11.2 historyæ¨¡å¼
1. åœ°å€å¹²å‡€ï¼Œç¾è§‚
2. å…¼å®¹æ€§å’Œhashæ¨¡å¼ç›¸æ¯”ç•¥å·®
3. åº”ç”¨éƒ¨ç½²ä¸Šçº¿æ—¶éœ€è¦åç«¯äººå‘˜æ”¯æŒï¼Œè§£å†³åˆ·æ–°é¡µé¢æœåŠ¡ç«¯404çš„é—®é¢˜
```javascript
const router =  new VueRouter({
	mode:'history',
	routes:[...]
})

export default router
```